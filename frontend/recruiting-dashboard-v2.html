<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recruiting Dashboard v2</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
  <div class="max-w-6xl mx-auto p-6">
    <h1 class="text-2xl font-bold mb-4">Recruiting Intelligence Dashboard â€” v2</h1>
    <div class="grid grid-cols-3 gap-4">
      <div class="bg-white rounded-lg shadow p-4">
        <h2 class="font-semibold mb-2">Benchmarks</h2>
        <pre id="benchmarks" class="text-xs text-gray-700 whitespace-pre-wrap"></pre>
      </div>
      <div class="bg-white rounded-lg shadow p-4 col-span-2">
        <h2 class="font-semibold mb-2">Latest Candidates</h2>
        <table class="w-full text-sm">
          <thead>
            <tr class="text-left text-gray-500">
              <th class="py-2">Name</th>
              <th class="py-2">Email</th>
              <th class="py-2">Score</th>
              <th class="py-2">Tier</th>
            </tr>
          </thead>
          <tbody id="candidates"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
  async function loadBenchmarks() {
    const res = await fetch('http://localhost:8000/api/enhanced-assessment/benchmarks', { headers: { 'x-api-key': 'demo_api_key_12345' } });
    const data = await res.json();
    document.getElementById('benchmarks').textContent = JSON.stringify(data, null, 2);
  }
  async function loadCandidates() {
    const res = await fetch('http://localhost:8000/api/leads', { headers: { 'x-tenant-id': 'default' } });
    const rows = await res.json();
    const tbody = document.getElementById('candidates');
    tbody.innerHTML = rows.slice(0, 10).map(r => `
      <tr class="border-t">
        <td class="py-2">${r.first_name || ''} ${r.last_name || ''}</td>
        <td class="py-2">${r.email || ''}</td>
        <td class="py-2">${r.final_score || ''}</td>
        <td class="py-2">${r.tier || ''}</td>
      </tr>
    `).join('');
  }
  // Simple filter UI
  const title = document.querySelector('h1');
  const filterBar = document.createElement('div');
  filterBar.className = 'mb-4';
  filterBar.innerHTML = '<input id="search" class="border rounded px-3 py-2" placeholder="Search email..." />';
  title.parentNode.insertBefore(filterBar, title.nextSibling);
  document.addEventListener('input', (e) => {
    if (e.target && e.target.id === 'search') {
      const q = e.target.value.toLowerCase();
      const rows = Array.from(document.querySelectorAll('#candidates tr'));
      rows.forEach(tr => {
        const email = tr.children[1].textContent.toLowerCase();
        tr.style.display = email.includes(q) ? '' : 'none';
      });
    }
  });
  // Basic filters example
  const ws = new WebSocket('ws://localhost:8001');
  ws.onmessage = () => { loadCandidates(); loadBenchmarks(); };
  loadBenchmarks();
  loadCandidates();
  </script>
</body>
</html>


