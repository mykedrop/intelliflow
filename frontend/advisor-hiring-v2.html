<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Northwestern Mutual - Financial Advisor Excellence Assessment</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' data: https://cdn.tailwindcss.com https://fonts.googleapis.com https://fonts.gstatic.com http://localhost:8000 http://127.0.0.1:8000; connect-src 'self' http://localhost:8000 http://127.0.0.1:8000; font-src https://fonts.gstatic.com data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: blob:; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com;">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); }
        .card-shadow { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
        .option-card { transition: all 0.2s ease-in-out; }
        .option-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.3); }
        .option-card.selected { border-color: #3b82f6; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); }
        .progress-bar { background: linear-gradient(90deg, #3b82f6 0%, #1d4ed8 100%); }
        .form-input:focus { box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen">
    <!-- Header -->
    <div class="gradient-bg text-white">
        <div class="max-w-6xl mx-auto px-6 py-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold tracking-tight">Northwestern Mutual</h1>
                    <p class="text-blue-100 text-lg mt-1">Financial Advisor Excellence Assessment</p>
                </div>
                <div class="text-right">
                    <div class="text-sm text-blue-200">Assessment v2.0</div>
                    <div class="text-xs text-blue-300">Powered by AI Intelligence</div>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-5xl mx-auto px-6 py-12">
        <!-- Contact Information Form -->
        <div id="contact-form" class="bg-white rounded-2xl card-shadow p-10 mb-8 border border-gray-100">
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 mb-2">Welcome to Northwestern Mutual</h2>
                <p class="text-gray-600 text-lg">Please provide your contact information to begin your personalized assessment</p>
            </div>
            
            <form id="candidate-form" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="first_name" class="block text-sm font-semibold text-gray-700 mb-2">First Name *</label>
                        <input type="text" id="first_name" name="first_name" required 
                               class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200">
                    </div>
                    <div>
                        <label for="last_name" class="block text-sm font-semibold text-gray-700 mb-2">Last Name *</label>
                        <input type="text" id="last_name" name="last_name" required 
                               class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200">
                    </div>
                </div>
                
                <div>
                    <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">Email Address *</label>
                    <input type="email" id="email" name="email" required 
                           class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="phone" class="block text-sm font-semibold text-gray-700 mb-2">Phone Number</label>
                        <input type="tel" id="phone" name="phone" 
                               class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                               placeholder="+1 (555) 123-4567">
                    </div>
                    <div>
                        <label for="company" class="block text-sm font-semibold text-gray-700 mb-2">Current Company</label>
                        <input type="text" id="company" name="company" 
                               class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                               placeholder="Optional">
                    </div>
                </div>
                
                <div>
                    <label for="job_title" class="block text-sm font-semibold text-gray-700 mb-2">Current Job Title</label>
                    <input type="text" id="job_title" name="job_title" 
                           class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                           placeholder="Optional">
                </div>
                
                <div class="pt-6">
                    <button type="submit" 
                            class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-4 px-8 rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 font-semibold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                        <span class="flex items-center justify-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                            </svg>
                            Begin Your Assessment
                        </span>
                    </button>
                </div>
            </form>
        </div>

        <!-- Assessment Container (Hidden initially) -->
        <div id="assessment-container" class="hidden">
            <!-- Progress Bar -->
            <div class="bg-white rounded-xl card-shadow p-6 mb-8 border border-gray-100">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900">Assessment Progress</h3>
                    <span id="progress-text" class="text-sm font-medium text-blue-600">Question 1 of 8</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-3">
                    <div id="progress-bar" class="progress-bar h-3 rounded-full transition-all duration-500" style="width: 12.5%"></div>
                </div>
            </div>

            <!-- Question Container -->
            <div id="question-container" class="bg-white rounded-2xl card-shadow p-10 mb-8 border border-gray-100">
                <!-- Questions will be dynamically inserted here -->
            </div>

            <!-- Navigation -->
            <div class="flex justify-between items-center">
                <button id="prev-btn" onclick="previousQuestion()" 
                        class="px-8 py-3 text-gray-600 bg-white border border-gray-300 rounded-xl hover:bg-gray-50 transition-all duration-200 font-medium shadow-sm hover:shadow-md hidden">
                    <span class="flex items-center">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        Previous
                    </span>
                </button>
                <div class="text-center">
                    <p class="text-sm text-gray-500">Your responses are being analyzed in real-time</p>
                </div>
                <button id="next-btn" onclick="nextQuestion()" 
                        class="px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 hidden">
                    <span class="flex items-center">
                        Next
                        <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </span>
                </button>
            </div>
        </div>
    </div>

    <script>
    const adaptiveAssessment = {
        baseQuestions: [
            {
                id: 'work_style',
                difficulty: 1,
                text: 'How do you prefer to approach your work?',
                subtitle: 'Select the approach that best describes your natural working style',
                type: 'single',
                options: [
                    { value: 'hunter', label: 'Hunter', description: 'Proactive and results-driven, focused on new business development' },
                    { value: 'farmer', label: 'Farmer', description: 'Relationship-focused, building long-term client partnerships' },
                    { value: 'analyst', label: 'Analyst', description: 'Data-driven and methodical, focused on research and planning' },
                    { value: 'coach', label: 'Coach', description: 'Mentoring and team development, helping others succeed' }
                ]
            },
            {
                id: 'client_approach',
                difficulty: 1,
                text: 'How do you prefer to work with clients?',
                subtitle: 'Choose the approach that resonates most with your philosophy',
                type: 'single',
                options: [
                    { value: 'educator', label: 'Educator', description: 'Teach clients about financial concepts and strategies' },
                    { value: 'consultant', label: 'Consultant', description: 'Provide expert advice and strategic guidance' },
                    { value: 'partner', label: 'Partner', description: 'Collaborate closely with clients on their financial journey' },
                    { value: 'advocate', label: 'Advocate', description: 'Champion clients\' best interests and protect their assets' }
                ]
            },
            {
                id: 'motivation',
                difficulty: 1,
                text: 'What motivates you most in your career?',
                subtitle: 'Select the primary driver of your professional success',
                type: 'single',
                options: [
                    { value: 'achievement', label: 'Achievement', description: 'Meeting goals and exceeding expectations' },
                    { value: 'impact', label: 'Impact', description: 'Making a positive difference in clients\' lives' },
                    { value: 'growth', label: 'Growth', description: 'Continuous learning and career advancement' },
                    { value: 'stability', label: 'Stability', description: 'Reliable income and long-term security' }
                ]
            },
            {
                id: 'challenge_response',
                difficulty: 2,
                text: 'When faced with a challenging client situation, you typically:',
                subtitle: 'Choose your most natural response pattern',
                type: 'single',
                options: [
                    { value: 'analyze', label: 'Analyze', description: 'Gather information and assess all options carefully' },
                    { value: 'act', label: 'Act', description: 'Take immediate action to address the issue' },
                    { value: 'collaborate', label: 'Collaborate', description: 'Work with the client to find a solution together' },
                    { value: 'delegate', label: 'Delegate', description: 'Involve appropriate experts or team members' }
                ]
            },
            {
                id: 'risk_tolerance',
                difficulty: 2,
                text: 'How would you describe your approach to risk management?',
                subtitle: 'Select the statement that best reflects your philosophy',
                type: 'single',
                options: [
                    { value: 'conservative', label: 'Conservative', description: 'Prioritize capital preservation and steady growth' },
                    { value: 'balanced', label: 'Balanced', description: 'Seek moderate risk for moderate returns' },
                    { value: 'aggressive', label: 'Aggressive', description: 'Accept higher risk for potentially higher returns' },
                    { value: 'adaptive', label: 'Adaptive', description: 'Adjust risk approach based on client needs and market conditions' }
                ]
            }
        ],
        conditionalQuestions: {
            hunter_followup: {
                condition: (responses) => responses.work_style === 'hunter',
                question: {
                    id: 'hunter_strategy',
                    difficulty: 2,
                    text: 'Describe your approach to finding new clients',
                    subtitle: 'Select the strategy that best describes your prospecting method',
                    type: 'scenario',
                    options: [
                        { value: 'network', label: 'Network', description: 'Leverage existing network and referrals' },
                        { value: 'cold', label: 'Cold Outreach', description: 'Direct prospecting and cold calling' },
                        { value: 'digital', label: 'Digital Marketing', description: 'Social media and online lead generation' },
                        { value: 'events', label: 'Events', description: 'Community involvement and event networking' }
                    ]
                }
            }
        }
    };

    const state = { 
        responses: {}, 
        behaviorData: { corrections: 0, hesitations: 0 }, 
        sessionId: null,
        contactInfo: {},
        currentQuestionIndex: 0
    };

    function updateProgress() {
        const totalQuestions = adaptiveAssessment.baseQuestions.length;
        const answered = Object.keys(state.responses).length;
        const progress = (answered / totalQuestions) * 100;
        
        document.getElementById('progress-bar').style.width = `${progress}%`;
        document.getElementById('progress-text').textContent = `Question ${answered + 1} of ${totalQuestions}`;
    }

    function render(question) {
        const el = document.getElementById('question-container');
        if (!question) { 
            el.innerHTML = `
                <div class="text-center py-16">
                    <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <h3 class="text-3xl font-bold text-gray-900 mb-4">Assessment Complete!</h3>
                    <p class="text-gray-600 text-lg mb-6">Thank you for completing the Northwestern Mutual Financial Advisor Excellence Assessment.</p>
                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 max-w-md mx-auto">
                        <p class="text-blue-800 font-medium">What happens next?</p>
                        <ul class="text-blue-700 text-sm mt-2 space-y-1">
                            <li>• Our team will review your responses</li>
                            <li>• You'll receive a detailed analysis within 24-48 hours</li>
                            <li>• If selected, we'll schedule a follow-up conversation</li>
                        </ul>
                    </div>
                </div>
            `; 
            return; 
        }
        
        let html = `
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-3">${question.text}</h2>
                <p class="text-gray-600 text-lg">${question.subtitle || 'Please select the option that best describes you'}</p>
            </div>
        `;

        if (question.type === 'single' || question.type === 'scenario') {
            html += '<div class="space-y-4">';
            question.options.forEach(opt => {
                html += `
                    <button class="option-card w-full text-left p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-all duration-200" 
                            onclick="selectOption('${question.id}','${opt.value}', event)">
                        <div class="flex items-start">
                            <div class="flex-shrink-0 w-6 h-6 border-2 border-gray-300 rounded-full mr-4 mt-1"></div>
                            <div class="flex-1">
                                <p class="font-semibold text-gray-900 text-lg mb-2">${opt.label}</p>
                                <p class="text-gray-600">${opt.description}</p>
                            </div>
                        </div>
                    </button>
                `;
            });
            html += '</div>';
        }

        el.innerHTML = html;
        updateProgress();
    }

    function selectOption(questionId, value, event) {
        // Remove previous selections
        document.querySelectorAll('.option-card').forEach(card => {
            card.classList.remove('selected');
            const radioButton = card.querySelector('.border-gray-300');
            if (radioButton) {
                radioButton.classList.remove('border-blue-500');
                radioButton.classList.add('border-gray-300');
            }
        });
        
        // Highlight selected option
        const selectedCard = event.currentTarget;
        selectedCard.classList.add('selected');
        const selectedRadio = selectedCard.querySelector('.border-gray-300');
        if (selectedRadio) {
            selectedRadio.classList.remove('border-gray-300');
            selectedRadio.classList.add('border-blue-500');
        }
        
        // Store response
        state.responses[questionId] = value;
        
        // Auto-advance after a brief delay
        setTimeout(() => {
            const next = selectNextQuestion(state.responses, state.behaviorData);
            if (next) {
                render(next);
            } else {
                completeAssessment();
            }
        }, 800);
    }

    function selectNextQuestion(responses, behaviorData) {
        for (const [key, config] of Object.entries(adaptiveAssessment.conditionalQuestions)) {
            if (config.condition(responses)) {
                if (config.question && !responses[config.question.id]) return config.question;
            }
        }
        return adaptiveAssessment.baseQuestions.find(q => !responses[q.id]);
    }

    async function startSession() {
        try {
            const res = await fetch('http://localhost:8000/api/enhanced-assessment/session/start', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'x-api-key': 'demo_api_key_12345' },
                body: JSON.stringify({ assessmentId: 'nm_v2' })
            });
            const data = await res.json();
            state.sessionId = data.sessionId;
        } catch (e) { console.error('Failed to start session', e); }
    }

    async function completeAssessment() {
        const payload = { 
            sessionId: state.sessionId, 
            responses: state.responses, 
            metadata: { 
                assessmentId: 'nm_v2',
                contactInfo: state.contactInfo
            } 
        };
        try {
            await fetch('http://localhost:8000/api/enhanced-assessment/submit', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'x-api-key': 'demo_api_key_12345' },
                body: JSON.stringify(payload)
            });
            render(null); // Show completion screen
        } catch (e) { console.error('Submit failed', e); }
    }

    // Handle contact form submission
    document.getElementById('candidate-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Collect contact information
        state.contactInfo = {
            first_name: document.getElementById('first_name').value,
            last_name: document.getElementById('last_name').value,
            email: document.getElementById('email').value,
            phone: document.getElementById('phone').value,
            company: document.getElementById('company').value,
            job_title: document.getElementById('job_title').value
        };
        
        // Hide contact form and show assessment
        document.getElementById('contact-form').classList.add('hidden');
        document.getElementById('assessment-container').classList.remove('hidden');
        
        // Start behavioral tracking session
        await startSession();
        
        // Start the assessment
        render(selectNextQuestion(state.responses, state.behaviorData));
    });
    </script>
</body>
</html>


